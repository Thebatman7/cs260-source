{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/rembr/OneDrive/BYU/Winter 2022/CS 260 Web/source/cs260-source/cp4-all/front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios'; //We first had to install it using npm install axios\n\nexport default {\n  name: 'Admin_',\n  data: function data() {\n    return {\n      title: \"\",\n      description: \"\",\n      //note\n      country: \"\",\n      city: \"\",\n      file: null,\n      addItem: null,\n      items: [],\n      //memories\n      findTitle: \"\",\n      //We'll use findTitle for the title the administrator types in and findItem for the item they click on in the suggestions list.\n      findItem: null,\n      empty: false\n    };\n  },\n  created: function created() {\n    this.getItems();\n  },\n  computed: {\n    /*This will be triggered whenever the findTitle property changes -- meaning the administrator has typed something \r\n    in the input field, even a single character. We create a list of suggestions using the filter higher-order function.\r\n    This creates a new list of items that contains only items where the title starts with the string the administrator has typed so far.\r\n    We convert to lowercase when doing the match to provide a case-insensitive match.*/\n    suggestions: function suggestions() {\n      var _this = this;\n\n      var items = this.items.filter(function (item) {\n        return item.title.toLowerCase().startsWith(_this.findTitle.toLowerCase());\n      });\n      return items.sort(function (a, b) {\n        return a.title > b.title;\n      });\n    },\n    emptyness: function emptyness() {\n      if (this.title !== \"\" && this.country !== \"\" && this.city !== \"\") {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  },\n  methods: {\n    fileChanged: function fileChanged(event) {\n      this.file = event.target.files[0];\n    },\n    upload: function upload() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var formData, r1, r2;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n\n                /*\r\n                We create a FormData object and append some information to it.\r\n                This is built in to JavaScript and is what we use to send a file to the server.\r\n                This information includes the property photo that the server will use to get the file from the form, the contents of the file, and the file name.\r\n                */\n                formData = new FormData();\n                formData.append('photo', _this2.file, _this2.file.name);\n                /*\r\n                We then post to /api/photos and include the FormData object.\r\n                Note that we use await to wait for this to finish, and we thus have made upload an async method.\r\n                The return value contains the path on the server where the file is stored.\r\n                */\n\n                _context.next = 5;\n                return axios.post('/api/photos', formData);\n\n              case 5:\n                r1 = _context.sent;\n\n                if (_this2.description == \"\") {\n                  _this2.description = \"no description for this memoery\";\n                }\n                /*\r\n                Once this first POST is done, we post to /api/items to create the item in our museum, \r\n                which includes the title and the path to the photo. We again use await here.\r\n                */\n\n\n                _context.next = 9;\n                return axios.post('/api/items', {\n                  title: _this2.title,\n                  description: _this2.description,\n                  //note, country state city image\n                  country: _this2.country,\n                  city: _this2.city,\n                  path: r1.data.path\n                });\n\n              case 9:\n                r2 = _context.sent;\n                _this2.addItem = r2.data;\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n                console.log(_context.t0); //remember to comment this out when uploading to DigitalOcean\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 13]]);\n      }))();\n    },\n    getItems: function getItems() {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var response;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return axios.get(\"/api/items\");\n\n              case 3:\n                response = _context2.sent;\n                _this3.items = response.data;\n                return _context2.abrupt(\"return\", true);\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.log(_context2.t0);\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 8]]);\n      }))();\n    },\n\n    /*\r\n    This will clear the input field and set findItem to the item they selected. \r\n    Because this is not null, the HTML we setup will show the title and photo for the item the administrator chose.\r\n    The delete button will also be displayed.*/\n    selectItem: function selectItem(item) {\n      this.findTitle = \"\";\n      this.findItem = item;\n    },\n\n    /*\r\n    This will use item._id to format the REST API endpoint we want to call.\r\n    Remember, the Mongo database automatically adds an _id field to every document in the database,\r\n    and it contains a long hexadecimal value that uniquely identifies the document.*/\n    deleteItem: function deleteItem(item) {\n      var _this4 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                _context3.next = 3;\n                return axios[\"delete\"](\"/api/items/\" + item._id);\n\n              case 3:\n                _this4.findItem = null;\n\n                _this4.getItems();\n\n                return _context3.abrupt(\"return\", true);\n\n              case 8:\n                _context3.prev = 8;\n                _context3.t0 = _context3[\"catch\"](0);\n                console.log(_context3.t0);\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[0, 8]]);\n      }))();\n    },\n    editItem: function editItem(item) {\n      var _this5 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return axios.put(\"/api/items/\" + item._id, {\n                  title: _this5.findItem.title,\n                  description: _this5.findItem.description\n                });\n\n              case 3:\n                _this5.findItem = null;\n\n                _this5.getItems();\n\n                return _context4.abrupt(\"return\", true);\n\n              case 8:\n                _context4.prev = 8;\n                _context4.t0 = _context4[\"catch\"](0);\n                console.log(_context4.t0);\n\n              case 11:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[0, 8]]);\n      }))();\n    },\n    blankInput: function blankInput() {\n      if (this.title !== \"\" && this.country !== \"\" && this.city !== \"\") {\n        this.empty == false;\n      } else {\n        this.epmty == true;\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA,0B,CAAA;;AACA;AACAA,gBADA;AAEAC,MAFA,kBAEA;AACA;AACAC,eADA;AAEAC,qBAFA;AAEA;AACAC,iBAHA;AAIAC,cAJA;AAKAC,gBALA;AAMAC,mBANA;AAOAC,eAPA;AAOA;AACAC,mBARA;AAQA;AACAC,oBATA;AAUAC;AAVA;AAYA,GAfA;AAgBAC,SAhBA,qBAgBA;AACA;AACA,GAlBA;AAmBAC;AACA;AACA;AACA;AACA;AACAC,eALA,yBAKA;AAAA;;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA,KARA;AASAC,aATA,uBASA;AACA;AACA;AACA,OAFA,MAGA;AACA;AACA;AACA;AAhBA,GAnBA;AAqCAC;AACAC,eADA,uBACAC,KADA,EACA;AACA;AACA,KAHA;AAIAC,UAJA,oBAIA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACAC,wBAPA,GAOA,cAPA;AAQAA;AACA;AACA;AACA;AACA;AACA;;AAbA;AAAA,uBAcAC,mCAdA;;AAAA;AAcAC,kBAdA;;AAeA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;AAnBA;AAAA,uBAoBAD;AACAnB,qCADA;AAEAC,iDAFA;AAEA;AACAC,yCAHA;AAIAC,mCAJA;AAKAkB;AALA,kBApBA;;AAAA;AAoBAC,kBApBA;AA2BA;AA3BA;AAAA;;AAAA;AAAA;AAAA;AA6BAC,yCA7BA,CA6BA;;AA7BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA+BA,KAnCA;AAoCAC,YApCA,sBAoCA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEAL,uBAFA;;AAAA;AAEAM,wBAFA;AAGA;AAHA,kDAIA,IAJA;;AAAA;AAAA;AAAA;AAMAF;;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA,KA5CA;;AA6CA;AACA;AACA;AACA;AACAG,cAjDA,sBAiDAC,IAjDA,EAiDA;AACA;AACA;AACA,KApDA;;AAqDA;AACA;AACA;AACA;AACAC,cAzDA,sBAyDAD,IAzDA,EAyDA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEAR,yCAFA;;AAAA;AAGA;;AACA;;AAJA,kDAKA,IALA;;AAAA;AAAA;AAAA;AAOAI;;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA,KAlEA;AAmEAM,YAnEA,oBAmEAF,IAnEA,EAmEA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEAR;AACAnB,8CADA;AAEAC;AAFA,kBAFA;;AAAA;AAMA;;AACA;;AAPA,kDAQA,IARA;;AAAA;AAAA;AAAA;AAUAsB;;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA,KA/EA;AAgFAO,cAhFA,wBAgFA;AACA;AACA;AACA,OAFA,MAGA;AACA;AACA;AACA;AAvFA;AArCA","names":["name","data","title","description","country","city","file","addItem","items","findTitle","findItem","empty","created","computed","suggestions","emptyness","methods","fileChanged","event","upload","formData","axios","r1","path","r2","console","getItems","response","selectItem","item","deleteItem","editItem","blankInput"],"sourceRoot":"src/views","sources":["Admin.vue"],"sourcesContent":["<template>\r\n<div class=\"admin\">\r\n\r\n  <div class=\"heading\">\r\n    <div class=\"circle\">1</div>\r\n    <h2>Add a Memory</h2>\r\n  </div>\r\n  <div class=\"add\">\r\n    <div class=\"form\">\r\n      <input v-model=\"title\" placeholder=\"Enter a memory\">\r\n      <p></p>\r\n      <textarea v-model=\"description\" description=\"description\" rows=\"6\" cols=\"23\" placeholder=\"Enter a discription (optional)\">\r\n      </textarea>\r\n      <p></p>\r\n      <input v-model=\"country\" placeholder=\"Enter a country\">\r\n      <p></p>\r\n      <input v-model=\"city\" placeholder=\"Enter a state or city\">\r\n      <p></p>\r\n      <!--We bind the title to a title model, for two-way data binding. \r\n      We add an event handler for the change event to the input for uploading a file.\r\n      This lets us keep track of which file the user selected.\r\n      We also have an event handler for the click event on an upload button, \r\n      so that we can upload the photo to our server.-->\r\n      <input type=\"file\" name=\"photo\" @change=\"fileChanged\">\r\n      <button @click=\"upload\" class=\"button\" v-if=\"em\">Upload</button> \r\n    </div>\r\n    <!--We have a div that will show the title of the item and the photo of the item that we uploaded.\r\n    This will display only after the item is successfully uploaded to the server.-->\r\n    <div class=\"upload\" v-if=\"addItem\">\r\n      <h2>{{addItem.title}}</h2>\r\n      <h1>{{addItem.description}}</h1>\r\n      <h1>{{addItem.country}}</h1>\r\n      <h1>{{addItem.city}}</h1>\r\n      <img :src=\"addItem.path\" />\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"heading\">\r\n    <div class=\"circle\">2</div>\r\n    <h2>Edit/Delete an Item</h2>\r\n  </div>\r\n  <div class=\"edit\">\r\n    <!--The first part of this provides a form where the administrator can type a title.\r\n    We use the v-model directive to bind this to the findTitle property.-->\r\n    <div class=\"form\">\r\n      <input v-model=\"findTitle\" placeholder=\"Search item\">\r\n      <!--\r\n        We will display suggestions in a dropdown menu right below this input.\r\n        We'll simply list them in some div elements and use CSS to style it.\r\n        We will setup a click event handler for when the administrator clicks on one of these suggestions and we'll call the selectItem method.-->\r\n      <div class=\"suggestions\" v-if=\"suggestions.length > 0\">\r\n        <div class=\"suggestion\" v-for=\"s in suggestions\" :key=\"s.id\" @click=\"selectItem(s)\">{{s.title}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!--We setup a div to show the item they selected, along with a button they can click to delete this item.\r\n    The property findItem will be bound to the item the user clicked on in the suggestions menu.-->\r\n    <div class=\"upload\" v-if=\"findItem\">\r\n      <input v-model=\"findItem.title\">\r\n      <p></p>\r\n      <textarea v-model=\"findItem.description\" description=\"description\" rows=\"5\" cols=\"33\" placeholder=\"Enter a discription\">\r\n      </textarea>\r\n      <img :src=\"findItem.path\" align=\"right\"/>\r\n    </div>\r\n    <div class=\"actions\" v-if=\"findItem\">\r\n      <button @click=\"deleteItem(findItem)\" class=\"button\">Delete</button>\r\n      <button @click=\"editItem(findItem)\" class=\"button\">Edit</button>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport axios from 'axios'; //We first had to install it using npm install axios\r\nexport default {\r\n  name: 'Admin_',\r\n  data() {\r\n    return {\r\n      title: \"\",\r\n      description: \"\",//note\r\n      country: \"\",\r\n      city: \"\",\r\n      file: null,\r\n      addItem: null,\r\n      items: [],//memories\r\n      findTitle: \"\", //We'll use findTitle for the title the administrator types in and findItem for the item they click on in the suggestions list.\r\n      findItem: null,\r\n      empty: false\r\n    }\r\n  },\r\n  created() {\r\n    this.getItems();\r\n  },\r\n  computed: {\r\n    /*This will be triggered whenever the findTitle property changes -- meaning the administrator has typed something \r\n    in the input field, even a single character. We create a list of suggestions using the filter higher-order function.\r\n    This creates a new list of items that contains only items where the title starts with the string the administrator has typed so far.\r\n    We convert to lowercase when doing the match to provide a case-insensitive match.*/\r\n    suggestions() {\r\n      let items = this.items.filter(item => item.title.toLowerCase().startsWith(this.findTitle.toLowerCase()));\r\n      return items.sort((a, b) => a.title > b.title);\r\n    },\r\n    emptyness() {\r\n      if(this.title !== \"\" && this.country !== \"\" && this.city !== \"\") {\r\n        return true; \r\n      }\r\n      else {\r\n        return false;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    fileChanged(event) {\r\n      this.file = event.target.files[0]\r\n    },\r\n    async upload() {//items without a title makes the code freakout \r\n      try {\r\n        /*\r\n        We create a FormData object and append some information to it.\r\n        This is built in to JavaScript and is what we use to send a file to the server.\r\n        This information includes the property photo that the server will use to get the file from the form, the contents of the file, and the file name.\r\n        */\r\n        const formData = new FormData();\r\n        formData.append('photo', this.file, this.file.name);\r\n        /*\r\n        We then post to /api/photos and include the FormData object.\r\n        Note that we use await to wait for this to finish, and we thus have made upload an async method.\r\n        The return value contains the path on the server where the file is stored.\r\n        */\r\n        let r1 = await axios.post('/api/photos', formData);\r\n        if(this.description == \"\") { this.description = \"no description for this memoery\"; }\r\n        /*\r\n        Once this first POST is done, we post to /api/items to create the item in our museum, \r\n        which includes the title and the path to the photo. We again use await here.\r\n        */\r\n        let r2 = await axios.post('/api/items', {\r\n          title: this.title,\r\n          description: this.description, //note, country state city image\r\n          country: this.country,\r\n          city: this.city,\r\n          path: r1.data.path\r\n        });\r\n        this.addItem = r2.data;\r\n      } catch (error) {\r\n        console.log(error);//remember to comment this out when uploading to DigitalOcean\r\n      }\r\n    },\r\n    async getItems() {\r\n      try {\r\n        let response = await axios.get(\"/api/items\");\r\n        this.items = response.data;\r\n        return true;\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    /*\r\n    This will clear the input field and set findItem to the item they selected. \r\n    Because this is not null, the HTML we setup will show the title and photo for the item the administrator chose.\r\n    The delete button will also be displayed.*/\r\n    selectItem(item) {\r\n      this.findTitle = \"\";\r\n      this.findItem = item;\r\n    },\r\n    /*\r\n    This will use item._id to format the REST API endpoint we want to call.\r\n    Remember, the Mongo database automatically adds an _id field to every document in the database,\r\n    and it contains a long hexadecimal value that uniquely identifies the document.*/\r\n    async deleteItem(item) {\r\n      try {\r\n        await axios.delete(\"/api/items/\" + item._id);\r\n        this.findItem = null;\r\n        this.getItems();\r\n        return true;\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    async editItem(item) { // although the title of image shows if there is actual input it saves as \"\" nad makes code freakout \r\n      try {\r\n        await axios.put(\"/api/items/\" + item._id, {\r\n          title: this.findItem.title, \r\n          description: this.findItem.description,\r\n        });\r\n        this.findItem = null;\r\n        this.getItems();\r\n        return true;\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    blankInput() {\r\n      if(this.title !== \"\" && this.country !== \"\" && this.city !== \"\") {\r\n        this.empty == false; \r\n      }\r\n      else {\r\n        this.epmty == true;\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.image h2 {\r\n  font-style: italic;\r\n  font-size: 1em;\r\n  \r\n}\r\n\r\n.heading {\r\n  display: flex;\r\n  margin-bottom: 20px;\r\n  margin-top: 20px;\r\n  color: #ccd6f6;\r\n}\r\n\r\n.heading h2 {\r\n  margin-top: 8px;\r\n  margin-left: 10px;\r\n  color: #ccd6f6;\r\n}\r\n\r\n.upload h2 {\r\n  color: #ccd6f6;\r\n}\r\n.upload h1 {\r\n  color: #ccd6f6;\r\n  font-size: 1em;\r\n  margin-top: 0;\r\n}\r\n.add,\r\n.edit {\r\n  display: flex;\r\n}\r\n\r\n.circle {\r\n  border-radius: 60%;\r\n  width: 26px;\r\n  height: 26px;\r\n  padding: 1px;\r\n  background: #ccd6f6;\r\n  color: #04633f;\r\n  text-align: center\r\n}\r\n\r\n/* Form */\r\ninput,\r\ntextarea,\r\nselect,\r\nbutton {\r\n  font-family: 'Montserrat', sans-serif;\r\n  font-size: 1em;\r\n  color:rgb(27, 192, 178) !important;\r\n  font-weight: 200 !important;\r\n  background-color: transparent;\r\n  border: 1px solid #12EBC9;\r\n  border-radius: 3.0px;\r\n  line-height: 1.2;\r\n  padding: 0.1em;\r\n}\r\n.button:hover {\r\n  background: #64ffdb46;\r\n}\r\n\r\n.form {\r\n  margin-right: 50px;\r\n}\r\n\r\n/* Uploaded images */\r\n.upload h2 {\r\n  margin: 0px;\r\n}\r\n\r\n.upload img {\r\n  max-width: 300px;\r\n}\r\n\r\n/* Suggestions */\r\n.suggestions {\r\n  width: 300px;\r\n  /* border: 1px solid #ccc; */\r\n  color: #ccd6f6;\r\n  text-decoration: none;\r\n}\r\n\r\n.suggestion {\r\n  min-height: 22px;\r\n}\r\n\r\n.suggestion:hover {\r\n  background-color: #64ffdb46;\r\n  color: #12EBC9;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}